---
layout: post
title: fsnotifyを使って自動で再読み込みされる設定ファイルを作る
date: '2021-08-01T00:17:00.000+09:00'
author: s sato
tags:
- go
---

大抵のサーバープログラムはなんらんかの設定ファイルをもっている。
PostgreSQLでいうとpostgresql.confやpg_hba.conf、nginxでいうとnginx.confだ。  
これらのプログラムはシグナルをつかって設定ファイルをサーバープロセスの再起動なしで反映するための仕組みを用意してくれていて、
いずれもSIGHUPをメインのプロセスに送ることで設定ファイルを再度読み込んでくれる。
これによってサーバーのダウンタイムなしでパラメーターを変更することができる。  

一方でRails(developmentモード)やwebpack-dev-serverの場合、ファイルを変更するとそれだけで
設定を反映してくれる。(これは設定ファイルというよりもソースコードそのものの変更を自動で検出して反映してくれる)  
Railsやwebpack-dev-serverの場合、ダウンタイムを防ぐのではなく開発中の確認作業を便利にするために、シグナルを明に受けなくても
設定が反映されるようになっている。  

このように設定を勝手に反映してくれるのは、意図せぬ変更が発生する可能性があるので、プロダクション環境のサーバーには不向きだが、
個人的に使うようなサーバーが必要な場合にはとても便利だ。  
Goで個人的に使うサーバープロセスを立てたかったので、これを試してみた。


## epollとfsnotify


## epollとfsnotify
